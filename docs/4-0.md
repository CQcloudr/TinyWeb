# **C++构建高性能Web服务器——Step 4-0：Http协议的实现**


## **一、想法:**

- 经过前几个大部分的综合设计，终于来到了业务逻辑层：```Http协议的实现```。如何实现Http逻辑，就是如何处理数据流，进行类似词法分析的相关处理，验证数据流是否符合Http规定，是否违法，是否有恶意的数据，这些都是我们要考虑到的。为了实现Http协议，主要采用状态机，通过一系列的状态转移来判断是否符合协议规则。在这里，我们希望我们的Http状态机能够做到以下几点：
    - 性能高效：在解析的时候区分不重要的状态和重要的状态
    - 可以根据我们规则的严格程度进行配置
    - 模块化设计、代码可重用
    - 安全性高、能够处理逻辑上的错误、识别恶意连接
    - 不动态分配内存，不会造成内存泄露
    - 能够多线程可重入

--------------------------

## **二、系列博客分类**

0.[前言]()

1.[基础类的介绍&实现]()

2.[基本数据结构的实现]()

3.[核心类的介绍&实现]()

4.[Http逻辑实现]()

5.[番外篇--各种难点&实现想法]()

--------------------------

## **三、设计过程中的知识储备**



### 1. 再设计我们需要知道的事情:

- Http各种方法
- Http状态码
- Http请求头Key-Value有哪几种
- 
- 

### 2.一些细节

#### 1.什么时候关闭连接

#### 2.chunked是么时候使用

#### 3.如何高效的匹配短字符串

#### 4.upgrade是干什么的

#### 5.什么时候执行严格检查，什么时候不进行严格检查

#### 6.什么时候接收Body，什么时候不接收Body

#### 7.什么时候要今早的关闭连接，以及什么时候可以尽快的判断消息已经接收完毕

#### 8.出现错误时该打哪些错误日志

#### 9.以```H```开头时，有可能是HTTP或HEAD方法

#### 10.Http 头部的Key-Value字段:
当是HTTP1.1以下版本是,Key中包含的字符只有Alp,Num,和"-","_"(允许的情况下)
当时HTTP2.0版本时:Key-Value的一般形式为```:key: value```,key为小写

Http Parser 设计架构

为了解析HTTP，我们采用两个类，一个是HttpParser类，主要是进行解析处理，另一个是HttpParserSettings，主要是进行回调函数的设置，刚开始接收到消息是如何处理，接收到请求头部时如何处理，消息接受完毕时如何处理。其实在HTTP解析的时候主要是同步进行处理，因为这时候消息流已经到来，不需要异步处理。

为了能够处理代理，```HttpParser```必须具有分别Request和Response的功能，


--------------------------

## **四、源码**


--------------------------

## **五、参考文献**
